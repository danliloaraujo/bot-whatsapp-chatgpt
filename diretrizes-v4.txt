ğŸ“„ DIRETRIZ v4.0 â€” Sistema de ValidaÃ§Ã£o CrÃ­tica (atualizada em 21/04/2025)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… 1. PRINCÃPIOS GERAIS

- Nenhuma tarefa pode ser executada sem seguir a diretriz
- Todo processo de versÃ£o deve ser validado em 8 etapas
- Qualquer violaÃ§Ã£o deve cancelar imediatamente a execuÃ§Ã£o

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§± 2. ESTRATÃ‰GIAS DE CONSISTÃŠNCIA

1. Repetir orientaÃ§Ãµes crÃ­ticas no final de cada resposta
2. Armazenar tudo em arquivo de diretrizes versionado
3. Rodar verificaÃ§Ã£o interna de comportamento antes de enviar ZIP
4. Toda diretriz nova exige revalidaÃ§Ã£o da versÃ£o atual

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª 3. ORGANIZAÃ‡ÃƒO POR THREADS (obrigatÃ³rio desde v49.9.11)

1ï¸âƒ£ Thread Principal (produÃ§Ã£o): desenvolvimento e validaÃ§Ã£o de versÃµes oficiais  
2ï¸âƒ£ Thread TÃ©cnica (auditoria): ESLint, validate.js, revisÃ£o linha por linha  
3ï¸âƒ£ Thread de Logs (deploy): erros no Render, webhook, variÃ¡veis de ambiente  
4ï¸âƒ£ Thread de Backups (estrutura): validaÃ§Ã£o de arquivos, comparaÃ§Ã£o de versÃµes, restauraÃ§Ã£o de base

Essas threads devem ser usadas conforme sua finalidade, e nenhuma versÃ£o serÃ¡ considerada vÃ¡lida se for gerada fora do fluxo aprovado.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” 4. VALIDAÃ‡Ã•ES AUTOMÃTICAS OBRIGATÃ“RIAS

- validate.js deve rodar localmente antes do ZIP
- ESLint (`npx eslint .`) deve retornar 0 erros
- Confirmar estrutura com todos os arquivos obrigatÃ³rios:
  index.js, validate.js, validator.js, .env.example, .gitignore,
  README.md, README-processo.md, package.json, src/consultativeBot.js, src/respostas.js

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  5. SISTEMA DE VALIDAÃ‡ÃƒO CRÃTICA â€” 8 PASSOS

1. Objetivo da versÃ£o
2. Estrutura do projeto
3. ValidaÃ§Ã£o com validate.js
4. ValidaÃ§Ã£o com ESLint
5. Comando Git para redeploy
6. Senso crÃ­tico e erros recorrentes
7. Checklist completo
8. ValidaÃ§Ã£o comportamental

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸ 6. DIRETRIZES ADICIONAIS (inclui estratÃ©gia de logs)

ğŸ§¾ AvaliaÃ§Ã£o estratÃ©gica de logs (desde v4.0):

- Toda versÃ£o com webhook ou automaÃ§Ã£o de atendimento deve prever logs funcionais.
- Logs devem ter prefixo versionado (ex: `ğŸ§ª v49.9.X`) para rastreabilidade.
- Logs mÃ­nimos obrigatÃ³rios:
  - Recebimento do payload
  - Mensagem identificada (com nÃºmero, tipo e corpo)
  - Resposta gerada pela IA
- Recomenda-se **agrupamento visual** com separadores tipo:
  ```
  ğŸ“© --- NOVA MENSAGEM RECEBIDA (vX.Y.Z) ---
  ```
- Opcionalmente, logs podem conter `timestamp` ou serem em `JSON.stringify(...)`
- Logs silenciosos (nÃ£o visÃ­veis no Render) devem ser tratados como falha de rastreabilidade
- Logs devem sempre estar posicionados:
  - Antes de qualquer `await delay(...)`
  - Fora de condicionais que possam ser ignoradas
  - Preferencialmente antes de `res.sendStatus(200)`

ğŸ“˜ Modelo de logs recomendados no Render:
```
ğŸ“© --- NOVA MENSAGEM RECEBIDA (v49.9.28) ---
ğŸ“¥ Payload bruto: {...}
ğŸ“¤ Mensagem identificada: { from: '55...', text: { body: '...' } }
ğŸ¤– Resposta gerada: OlÃ¡, como posso te ajudar?
ğŸ“¡ Enviando resposta para API WhatsApp...
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

